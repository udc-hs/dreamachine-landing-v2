<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dreamachine – Immersive Visual Experience</title>
  <meta name="description" content="Dreamachine creates immersive visual experiences through synchronized videos and interactive design.">
  <meta name="keywords" content="Dreamachine, immersive experience, interactive art, synchronized video, creative technology">
  <meta name="robots" content="index,follow">
  <link rel="canonical" href="https://thedreamachine.com/">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://thedreamachine.com/">
  <meta property="og:title" content="Dreamachine – Immersive Visual Experience">
  <meta property="og:description" content="Explore Dreamachine's interactive visuals that blend art and technology.">
  <meta property="og:image" content="https://freight.cargo.site/t/original/i/R2192464133004486997848030041226/DM_Logo_for_web_V01-no-bottom-bit.png">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://thedreamachine.com/">
  <meta name="twitter:title" content="Dreamachine – Immersive Visual Experience">
  <meta name="twitter:description" content="Explore Dreamachine's interactive visuals that blend art and technology.">
  <meta name="twitter:image" content="https://freight.cargo.site/t/original/i/R2192464133004486997848030041226/DM_Logo_for_web_V01-no-bottom-bit.png">

  <!-- Google Fonts - Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Dreamachine",
    "url": "https://thedreamachine.com/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://thedreamachine.com/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  <style>
    /* Ensure fullscreen layout */
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      width: 100%;
      height: 100%;
    }

    /* Common styles for both videos */
    .video-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      pointer-events: none;
    }

    /* The top video has a circular reveal effect with feathered edges */
    .top-video {
      position: absolute;
      -webkit-mask-image: radial-gradient(circle, rgba(0,0,0,1) 50%, rgba(0,0,0,0) 100%);
      mask-image: radial-gradient(circle, rgba(0,0,0,1) 50%, rgba(0,0,0,0) 100%);
      transition: mask-image 0.05s ease-out, -webkit-mask-image 0.05s ease-out;
    }

    /* Clickable Logo */
    .logo {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80vw;  /* Responsive: 80% of viewport width */
      max-width: 1000px;  /* Prevents the logo from becoming too large */
      height: auto;
      cursor: pointer;
      z-index: 10; /* Ensures it's above videos */
    }

    /* Full-screen preloader */
    #preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: #000000;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 1;
      transition: opacity 0.8s ease-in-out;
    }

    #preloader.fade-out {
      opacity: 0;
      pointer-events: none;
    }

    #preloaderPercent {
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-weight: 500;
      font-size: clamp(4rem, 12vw, 8rem);
      color: #ffffff;
      text-align: center;
      letter-spacing: -0.02em;
    }

    /* Video fade-in effect */
    .video-container {
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }

    .video-container.loaded {
      opacity: 1;
    }
  </style>
</head>
<body>

  <!-- Full-screen preloader -->
  <div id="preloader">
    <span id="preloaderPercent">0%</span>
  </div>

  <!-- Bottom Video -->
  <video id="bottomVideo" class="video-container" muted playsinline loop preload="metadata">
    <source src="https://freight.cargo.site/m/L2190992256300586244793696638090/AI-BLACK.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>

  <!-- Top Video (initially covering the bottom one) -->
  <video id="topVideo" class="video-container top-video" muted playsinline loop preload="metadata">
    <source src="https://freight.cargo.site/m/A2191010521805399430148968010890/inverted-depth.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>

  <!-- Clickable Logo -->
  <a href="mailto:hello@thedreamachine.com?subject=Portfolio%20Request&body=Hello,%20I%20would%20like%20to%20know%20more%20about...">
    <img src="https://freight.cargo.site/t/original/i/R2192464133004486997848030041226/DM_Logo_for_web_V01-no-bottom-bit.png" alt="Dreamachine logo" class="logo">
  </a>

  <script>
    const topVideo = document.getElementById("topVideo");
    const bottomVideo = document.getElementById("bottomVideo");
    const preloader = document.getElementById("preloader");
    const preloaderPercent = document.getElementById("preloaderPercent");

    let revealRadius = 50; // Size of the fully revealed area (hard edge)
    let featherRadius = 300; // Additional soft feathered edge
    
    // Loading progress tracking
    let topVideoLoaded = false;
    let bottomVideoLoaded = false;
    let videosStarted = false;
    let visualCounterComplete = false;
    let visualCounterValue = 0;

    // Visual counter animation (independent of actual loading progress)
    function animateVisualCounter() {
      const duration = 1800; // 1.8 seconds
      const startTime = performance.now();
      
      function updateCounter(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        visualCounterValue = Math.floor(progress * 100);
        preloaderPercent.textContent = `${visualCounterValue}%`;
        
        if (progress < 1) {
          requestAnimationFrame(updateCounter);
        } else {
          visualCounterComplete = true;
          checkReadyToStart();
        }
      }
      
      requestAnimationFrame(updateCounter);
    }

    // Check if both visual counter and videos are ready, then start
    function checkReadyToStart() {
      if (visualCounterComplete && topVideoLoaded && bottomVideoLoaded && !videosStarted) {
        videosStarted = true;
        
        // Small delay to let the 100% display briefly
        setTimeout(() => {
          startSyncedPlayback();
          fadeOutPreloader();
        }, 200);
      }
    }

    // Fade out the preloader
    function fadeOutPreloader() {
      preloader.classList.add('fade-out');
      
      // Remove from DOM after transition completes
      setTimeout(() => {
        preloader.style.display = 'none';
      }, 800);
    }

    // Start synchronized video playback with fade-in
    function startSyncedPlayback() {
      // Reset both videos to start
      topVideo.currentTime = 0;
      bottomVideo.currentTime = 0;

      // Play both videos simultaneously
      Promise.all([topVideo.play(), bottomVideo.play()])
        .then(() => {
          console.log("Both videos started in sync");
          
          // Fade in videos
          topVideo.classList.add('loaded');
          bottomVideo.classList.add('loaded');
        })
        .catch(error => {
          console.error("Error playing videos:", error);
          // Fallback: still show videos even if autoplay fails
          topVideo.classList.add('loaded');
          bottomVideo.classList.add('loaded');
        });
    }

    // Video loading event handlers
    function onVideoCanPlay(video, isTop) {
      if (isTop) {
        topVideoLoaded = true;
      } else {
        bottomVideoLoaded = true;
      }
      
      checkReadyToStart();
    }

    // Set up video loading listeners
    topVideo.addEventListener("canplay", () => onVideoCanPlay(topVideo, true));
    bottomVideo.addEventListener("canplay", () => onVideoCanPlay(bottomVideo, false));
    
    // Fallback loading detection
    topVideo.addEventListener("loadeddata", () => {
      if (!topVideoLoaded) {
        onVideoCanPlay(topVideo, true);
      }
    });
    
    bottomVideo.addEventListener("loadeddata", () => {
      if (!bottomVideoLoaded) {
        onVideoCanPlay(bottomVideo, false);
      }
    });

    // Restart videos in sync when they end (backup to loop attribute)
    function restartVideos() {
      if (videosStarted) {
        topVideo.currentTime = 0;
        bottomVideo.currentTime = 0;
      }
    }

    // Sync playback speeds (prevents drift over time)
    function matchPlaybackRates() {
      if (videosStarted) {
        bottomVideo.playbackRate = topVideo.playbackRate;
      }
    }

    // Sync playback rates continuously
    topVideo.addEventListener("ratechange", matchPlaybackRates);

    // Ensure both videos restart together (backup to loop)
    topVideo.addEventListener("ended", restartVideos);
    bottomVideo.addEventListener("ended", restartVideos);

    // Apply radial mask based on coordinates
    function updateMask(x, y) {
      const maskStyle = `radial-gradient(circle ${revealRadius + featherRadius}px at ${x}px ${y}px,
                          rgba(0,0,0,1) ${revealRadius}px,
                          rgba(0,0,0,0) ${revealRadius + featherRadius}px)`;
      topVideo.style.maskImage = maskStyle;
      topVideo.style.webkitMaskImage = maskStyle;
    }

    // Mouse movement effect for reveal with a hard center and feathered edges
    document.addEventListener("mousemove", (event) => {
      updateMask(event.clientX || 0, event.clientY || 0);
    });

    // Touch movement support for mobile devices
    document.addEventListener("touchmove", (event) => {
      const touch = event.touches[0];
      if (touch) {
        updateMask(touch.clientX, touch.clientY);
      }
    });

    // Fallback timer in case loading events don't fire properly
    setTimeout(() => {
      if (!videosStarted) {
        console.log("Fallback: Starting videos after timeout");
        // Force mark as loaded and start if visual counter is done
        topVideoLoaded = true;
        bottomVideoLoaded = true;
        checkReadyToStart();
        
        // If visual counter isn't done yet, force complete it
        if (!visualCounterComplete) {
          visualCounterComplete = true;
          preloaderPercent.textContent = "100%";
          checkReadyToStart();
        }
      }
    }, 10000); // 10 second fallback

    // Start the visual counter animation
    animateVisualCounter();

  </script>

</body>
</html>
